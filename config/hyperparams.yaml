# Model Training Hyperparameters

# Training Configuration
training:
  # Number of training epochs
  epochs: 200
  # Batch size for training
  batch_size: 16
  # Batch size for validation
  val_batch_size: 32
  # Learning rate
  learning_rate: 0.0001
  # Weight decay
  weight_decay: 0.0001
  # Gradient clipping threshold
  grad_clip: 1.0
  
  # Data split ratios
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  
  # Random seed for reproducibility
  seed: 42
  
  # Number of data loading workers
  num_workers: 4
  
  # Pin memory for faster GPU transfer
  pin_memory: true
  
# Optimizer Configuration
optimizer:
  # Options: 'adam', 'adamw', 'sgd'
  type: "adamw"
  # Beta parameters for Adam/AdamW
  betas: [0.9, 0.999]
  # Epsilon for numerical stability
  eps: 1.0e-8
  # Momentum for SGD
  momentum: 0.9
  
# Learning Rate Scheduler
scheduler:
  # Options: 'cosine', 'step', 'plateau', 'exponential'
  type: "cosine"
  # Minimum learning rate
  min_lr: 1.0e-7
  # For StepLR: step size
  step_size: 30
  # For StepLR: decay factor
  gamma: 0.1
  # For ReduceLROnPlateau: patience
  patience: 10
  # For ReduceLROnPlateau: factor
  factor: 0.5
  
# Loss Function
loss:
  # Primary loss type: 'bce', 'dice', 'focal', 'combined'
  type: "combined"
  # Weights for combined loss [bce_weight, dice_weight]
  weights: [0.5, 0.5]
  # Focal loss gamma (if using focal loss)
  focal_gamma: 2.0
  # Focal loss alpha (if using focal loss)
  focal_alpha: 0.25
  
# Early Stopping
early_stopping:
  # Enable early stopping
  enabled: true
  # Patience (epochs without improvement)
  patience: 20
  # Minimum delta for improvement
  min_delta: 0.0001
  # Metric to monitor: 'val_loss', 'val_iou', 'val_dice'
  monitor: "val_loss"
  # Mode: 'min' (for loss) or 'max' (for metrics)
  mode: "min"
  
# Model Checkpointing
checkpointing:
  # Save checkpoint every N epochs
  save_freq: 5
  # Save only the best model
  save_best_only: true
  # Metric to monitor for best model
  monitor: "val_iou"
  # Mode: 'min' or 'max'
  mode: "max"
  
# Model Architecture
model:
  # Model type: 'unet', 'deeplabv3plus', 'yolov11_seg'
  type: "unet"
  # Encoder backbone: 'resnet34', 'resnet50', 'efficientnet-b0', etc.
  encoder: "resnet34"
  # Use pre-trained weights for encoder
  pretrained: true
  # Number of input channels
  in_channels: 3
  # Number of output classes
  num_classes: 1
  # Activation function: 'sigmoid', 'softmax'
  activation: "sigmoid"
  
# Data Augmentation
augmentation:
  # Training augmentations
  train:
    # Random horizontal flip
    horizontal_flip: 0.5
    # Random vertical flip
    vertical_flip: 0.5
    # Random rotation (degrees)
    rotate_limit: 30
    # Random shift, scale, rotate
    shift_scale_rotate:
      shift_limit: 0.1
      scale_limit: 0.2
      rotate_limit: 30
      p: 0.5
    # Random brightness and contrast
    brightness_contrast:
      brightness_limit: 0.2
      contrast_limit: 0.2
      p: 0.5
    # Gaussian blur
    blur:
      blur_limit: 7
      p: 0.3
    # Gaussian noise
    gaussian_noise:
      var_limit: [10, 50]
      p: 0.3
    # Grid distortion
    grid_distortion:
      p: 0.3
    # Elastic transform
    elastic_transform:
      alpha: 1
      sigma: 50
      p: 0.3
      
  # Validation augmentations (usually just normalization)
  val:
    normalize: true
    
  # Image size for training
  image_size: [512, 512]
  
  # Normalization parameters (ImageNet)
  normalize:
    mean: [0.485, 0.456, 0.406]
    std: [0.229, 0.224, 0.225]
    
# Inference Configuration
inference:
  # Batch size for inference
  batch_size: 8
  # Threshold for binary masks
  threshold: 0.5
  # Post-processing
  post_process:
    # Morphological operations
    morphology:
      # Operation: 'open', 'close', 'dilate', 'erode', 'none'
      operation: "close"
      # Kernel size
      kernel_size: 5
    # Connected components filtering
    min_area: 100
    # Maximum number of components to keep
    max_components: 10
    
# Evaluation Metrics
metrics:
  # Metrics to compute: 'iou', 'dice', 'precision', 'recall', 'f1'
  compute: ['iou', 'dice', 'precision', 'recall', 'f1']
  # Average mode: 'binary', 'micro', 'macro'
  average: 'binary'
